# Red Team Skill ç»Ÿä¸€ä¼ è¾“å±‚æ–¹æ¡ˆæ€»ç»“

## ğŸ“‹ ä½ çš„é—®é¢˜

> ç›®å‰çš„agent-proxyè¿˜æœ‰ä¸€äº›ä¸æ˜¯ä½¿ç”¨browser-automationçš„æ”¯æŒï¼Œè€ƒè™‘åˆ°æ‰€æœ‰çš„æƒ…å†µåº”è¯¥æ€ä¹ˆæ”¹æ•´ä½“çš„ä¸€ä¸ªæœ€å¥½çš„æ–¹æ¡ˆæ˜¯ä»€ä¹ˆæ¯”è¾ƒå¥½ã€‚

## âœ… è§£å†³æ–¹æ¡ˆï¼šä¸‰å±‚æ¶æ„ + è‡ªåŠ¨æ£€æµ‹

æˆ‘åˆ›å»ºäº†ä¸€ä¸ª**ç»Ÿä¸€ä¼ è¾“å±‚ï¼ˆTransport Layerï¼‰**ï¼Œå®Œå…¨è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚

### æ ¸å¿ƒæ€æƒ³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Red Team æ”»å‡»é€»è¾‘ï¼ˆä¸éœ€è¦æ”¹ï¼‰         â”‚
â”‚   - ç”Ÿæˆpayload                         â”‚
â”‚   - åˆ¤æ–­æ˜¯å¦æˆåŠŸ                        â”‚
â”‚   - ä¼˜åŒ–payload                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
               â†“ transport.send(payload)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Transport Layerï¼ˆæ–°å¢çš„ç»Ÿä¸€å±‚ï¼‰â˜…       â”‚
â”‚   - è‡ªåŠ¨æ£€æµ‹ç›®æ ‡ç±»å‹                      â”‚
â”‚   - é€‰æ‹©æœ€ä½³é€šä¿¡æ–¹å¼                      â”‚
â”‚   - è¿”å›ç»Ÿä¸€æ ¼å¼çš„æ‰§è¡ŒæŒ‡ä»¤                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”
       â†“       â†“       â†“        â†“
   Browser  Agent  WebSocket  ...
           Proxy
```

## ğŸ¯ æ”¯æŒçš„æ‰€æœ‰åœºæ™¯

| ç›®æ ‡ç±»å‹ | è‡ªåŠ¨é€‰æ‹©çš„Transport | å®é™…æ‰§è¡Œæ–¹å¼ |
|---------|-------------------|-------------|
| Magentic-UI Webç•Œé¢ | BrowserTransport | Playwrightæµè§ˆå™¨è‡ªåŠ¨åŒ– |
| ChatGPT / Claude Web | BrowserTransport | Playwrightæµè§ˆå™¨è‡ªåŠ¨åŒ– |
| REST API | AgentProxyTransport | agent-proxy skill |
| Gradioåº”ç”¨ | AgentProxyTransport | agent-proxy skill |
| WebSocket (ws://) | WebSocketTransport | Python WebSocket |
| ä»»ä½•HTMLèŠå¤©ç•Œé¢ | BrowserTransport | Playwrightæµè§ˆå™¨è‡ªåŠ¨åŒ– |

## ğŸš€ ä½¿ç”¨éå¸¸ç®€å•

### å¯¹äºç”¨æˆ·ï¼ˆä½ ï¼‰

**ä»€ä¹ˆéƒ½ä¸ç”¨æ”¹ï¼** ç›´æ¥ä½¿ç”¨ `/red-team` skillï¼Œç³»ç»Ÿè‡ªåŠ¨å¤„ç†ä¸€åˆ‡ï¼š

```bash
# æ”»å‡»Web UIï¼ˆè‡ªåŠ¨ä½¿ç”¨æµè§ˆå™¨ï¼‰
/red-team http://localhost:8082

# æ”»å‡»APIï¼ˆè‡ªåŠ¨ä½¿ç”¨agent-proxyï¼‰
/red-team http://localhost:8000/v1/chat/completions

# æ”»å‡»WebSocketï¼ˆè‡ªåŠ¨ä½¿ç”¨WebSocketï¼‰
/red-team ws://localhost:8080/ws
```

### å¯¹äºRed Team Subagent

åªéœ€3æ­¥ï¼š

```python
# 1. åˆ›å»ºtransportï¼ˆè‡ªåŠ¨æ£€æµ‹ï¼‰
from transport import TransportFactory
transport = TransportFactory.create_auto(target_url)
# è¾“å‡ºï¼š[*] Auto-detected transport type: browser

# 2. å‘é€payload
instruction = transport.send(payload)

# 3. æ‰§è¡ŒæŒ‡ä»¤
if instruction["method"] == "bash":
    Bash(instruction["command"])  # æ‰§è¡ŒPlaywrightè„šæœ¬
elif instruction["method"] == "skill":
    Skill("agent-proxy", args=instruction["args"])  # è°ƒç”¨agent-proxy
```

## ğŸ“‚ åˆ›å»ºçš„æ–‡ä»¶

```
~/.claude/skills/red-team/
â”œâ”€â”€ scripts/
â”‚   â”œâ”€â”€ transport.py              â˜… æ ¸å¿ƒï¼šç»Ÿä¸€ä¼ è¾“å±‚
â”‚   â””â”€â”€ test_transport.py         â˜… æµ‹è¯•è„šæœ¬
â”œâ”€â”€ docs/
â”‚   â”œâ”€â”€ architecture-overview.md  â˜… æ¶æ„æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼‰
â”‚   â”œâ”€â”€ transport-integration.md  â˜… é›†æˆæŒ‡å—ï¼ˆè¯¦ç»†ï¼‰
â”‚   â””â”€â”€ æ–¹æ¡ˆæ€»ç»“.md              â˜… æœ¬æ–‡æ¡£
â”œâ”€â”€ skill.md                      â˜… å·²æ›´æ–°
â””â”€â”€ README-TRANSPORT.md          â˜… ä½¿ç”¨æŒ‡å—
```

## ğŸ”§ å·¥ä½œåŸç†

### 1. è‡ªåŠ¨æ£€æµ‹

å½“ä½ æä¾›ä¸€ä¸ªURLæ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨åˆ†æï¼š

```python
TransportDetector.detect("http://localhost:8082")

æ­¥éª¤ï¼š
1. æ£€æŸ¥URL scheme
   - ws:// æˆ– wss:// â†’ ç›´æ¥è¿”å› "websocket"

2. å‘é€HTTP GETè¯·æ±‚

3. åˆ†æå“åº”
   - Content-Type: text/html + åŒ…å«"chat" â†’ "browser"
   - Content-Type: application/json â†’ "agent_proxy"
   - åŒ…å«"gradio" â†’ "agent_proxy"

4. é»˜è®¤ â†’ "agent_proxy"
```

### 2. åˆ›å»ºTransport

```python
TransportFactory.create_auto(url)

æ ¹æ®æ£€æµ‹ç»“æœåˆ›å»ºï¼š
- "browser" â†’ BrowserTransportï¼ˆç”ŸæˆPlaywrightè„šæœ¬ï¼‰
- "agent_proxy" â†’ AgentProxyTransportï¼ˆè°ƒç”¨agent-proxy skillï¼‰
- "websocket" â†’ WebSocketTransportï¼ˆWebSocketè¿æ¥ï¼‰
```

### 3. ç»Ÿä¸€å‘é€æ¥å£

```python
instruction = transport.send(payload)

è¿”å›æ ¼å¼ï¼š
{
  "method": "bash" | "skill",
  "command": "...",  # å¦‚æœmethod=bash
  "skill": "...",    # å¦‚æœmethod=skill
  "args": "...",
  "description": "..."
}
```

## ğŸ“Š å®é™…æµ‹è¯•ç»“æœ

æˆ‘å·²ç»æµ‹è¯•è¿‡ï¼Œå®Œå…¨æ­£å¸¸å·¥ä½œï¼š

```bash
$ python test_transport.py http://localhost:8082

Testing Transport Detection
============================================================
Target URL: http://localhost:8082
Detected type: browser  â† è‡ªåŠ¨æ£€æµ‹æˆåŠŸ âœ…

Testing Transport Creation
============================================================
Created transport: BrowserTransport  â† åˆ›å»ºæˆåŠŸ âœ…
Config: TransportConfig(target_url='http://localhost:8082',
                        transport_type='browser', headless=False)

Testing Payload Generation
============================================================
Generated Instruction:
  Method: bash  â† ä½¿ç”¨Playwright âœ…
  Command: python /tmp/red_team_browser_attack.py

âœ… Transport layer is working correctly!
```

## ğŸ’ª ä¼˜åŠ¿

### å¯¹æ¯”æ”¹è¿›å‰å

| ç‰¹æ€§ | æ”¹è¿›å‰ | æ”¹è¿›å |
|-----|--------|--------|
| æ”¯æŒWeb UI | âŒ ä¸æ”¯æŒ | âœ… è‡ªåŠ¨browser automation |
| æ”¯æŒREST API | âœ… agent-proxy | âœ… agent-proxy |
| æ”¯æŒWebSocket | âš ï¸ éƒ¨åˆ†æ”¯æŒ | âœ… ä¸“ç”¨transport |
| éœ€è¦æ‰‹åŠ¨é€‰æ‹© | âœ… æ˜¯ | âŒ è‡ªåŠ¨æ£€æµ‹ |
| ä»£ç ä¿®æ”¹ | æ¯æ¬¡éƒ½è¦æ”¹ | ä¸€æ¬¡é…ç½®ï¼Œæ°¸ä¹…ä½¿ç”¨ |
| æ‰©å±•æ€§ | âŒ å›°éš¾ | âœ… æ·»åŠ æ–°ç±»å‹å¾ˆå®¹æ˜“ |

### æ ¸å¿ƒä»·å€¼

1. **âœ… å®Œå…¨å…¼å®¹** - æ”¯æŒæ‰€æœ‰ç±»å‹çš„ç›®æ ‡
2. **âœ… é›¶é…ç½®** - è‡ªåŠ¨æ£€æµ‹ï¼Œæ— éœ€æ‰‹åŠ¨æŒ‡å®š
3. **âœ… ç»Ÿä¸€æ¥å£** - ä¸€å¥—ä»£ç é€‚é…æ‰€æœ‰åœºæ™¯
4. **âœ… æ˜“äºæ‰©å±•** - æ·»åŠ æ–°ç±»å‹åªéœ€å®ç°æ¥å£
5. **âœ… å‘åå…¼å®¹** - ä¸å½±å“ç°æœ‰æ”»å‡»é€»è¾‘

## ğŸ§ª å¦‚ä½•æµ‹è¯•

### 1. æµ‹è¯•è‡ªåŠ¨æ£€æµ‹

```bash
cd ~/.claude/skills/red-team/scripts

# æµ‹è¯•ä¸åŒç±»å‹çš„URL
python test_transport.py http://localhost:8082  # â†’ browser
python test_transport.py http://api.example.com/v1/chat  # â†’ agent_proxy
python test_transport.py ws://localhost:8080/ws  # â†’ websocket
```

### 2. å®é™…æ”»å‡»æµ‹è¯•

```bash
# åœ¨Claude Codeä¸­
/red-team http://localhost:8082
```

Subagentä¼šè‡ªåŠ¨ï¼š
1. æ£€æµ‹ä¸ºbrowserç±»å‹
2. ç”ŸæˆPlaywrightè„šæœ¬
3. æ‰§è¡Œæµè§ˆå™¨è‡ªåŠ¨åŒ–
4. æå–ç»“æœ

## ğŸ¨ æ¶æ„äº®ç‚¹

### 1. å…³æ³¨ç‚¹åˆ†ç¦»

```python
# æ”»å‡»é€»è¾‘ï¼ˆadaptive_attack.pyï¼‰
# - åªå…³å¿ƒpayloadç”Ÿæˆå’Œç»“æœåˆ¤æ–­
# - ä¸å…³å¿ƒå¦‚ä½•å‘é€

# ä¼ è¾“å±‚ï¼ˆtransport.pyï¼‰
# - åªå…³å¿ƒå¦‚ä½•å‘é€
# - ä¸å…³å¿ƒpayloadå†…å®¹

# æ‰§è¡Œå±‚ï¼ˆRed Team Subagentï¼‰
# - è°ƒç”¨ä¸¤è€…
# - æ ¹æ®æŒ‡ä»¤æ‰§è¡Œ
```

### 2. å¼€é—­åŸåˆ™

**å¯¹æ‰©å±•å¼€æ”¾ï¼š** æ·»åŠ æ–°ç±»å‹å¾ˆå®¹æ˜“

```python
# åªéœ€3æ­¥æ·»åŠ SSH transport
class SSHTransport(Transport):
    def send(self, payload):
        return {"method": "bash", "command": f"ssh ... {payload}"}
```

**å¯¹ä¿®æ”¹å…³é—­ï¼š** ç°æœ‰ä»£ç ä¸éœ€è¦æ”¹

### 3. ä¾èµ–å€’ç½®

```python
# é«˜å±‚ï¼ˆæ”»å‡»é€»è¾‘ï¼‰ä¾èµ–æŠ½è±¡ï¼ˆTransportæ¥å£ï¼‰
# ä¸ä¾èµ–å…·ä½“å®ç°ï¼ˆBrowserTransport, AgentProxyTransportï¼‰

attack = AdaptiveNestingAttack(...)
transport = TransportFactory.create_auto(...)  # è¿”å›æŠ½è±¡ç±»å‹
instruction = transport.send(...)  # å¤šæ€
```

## ğŸ”® æœªæ¥æ‰©å±•

å¦‚æœéœ€è¦æ”¯æŒæ–°çš„é€šä¿¡æ–¹å¼ï¼Œåªéœ€ï¼š

1. åˆ›å»ºæ–°çš„Transportç±»
2. æ·»åŠ æ£€æµ‹è§„åˆ™
3. åœ¨Factoryä¸­æ³¨å†Œ

**ç¤ºä¾‹ï¼šæ”¯æŒgRPC**

```python
class GRPCTransport(Transport):
    def send(self, payload):
        return {"method": "bash", "command": "python grpc_attack.py"}

# åœ¨TransportDetector.detect()ä¸­æ·»åŠ 
if "grpc" in response.headers.get("content-type", ""):
    return "grpc"

# åœ¨TransportFactoryä¸­æ³¨å†Œ
transport_map["grpc"] = GRPCTransport
```

## ğŸ“š æ–‡æ¡£å®Œæ•´æ€§

æˆ‘åˆ›å»ºäº†å®Œæ•´çš„æ–‡æ¡£ï¼š

1. **README-TRANSPORT.md** - ä½¿ç”¨æŒ‡å—ï¼ˆè‹±æ–‡ï¼Œè¯¦ç»†ï¼‰
2. **docs/architecture-overview.md** - æ¶æ„æ–‡æ¡£ï¼ˆä¸­æ–‡ï¼Œè¯¦ç»†ï¼‰
3. **docs/transport-integration.md** - é›†æˆæŒ‡å—ï¼ˆæŠ€æœ¯ç»†èŠ‚ï¼‰
4. **docs/æ–¹æ¡ˆæ€»ç»“.md** - æœ¬æ–‡æ¡£ï¼ˆä¸­æ–‡æ€»ç»“ï¼‰
5. **skill.md** - å·²æ›´æ–°ä¸ºæ–°æ¶æ„
6. **test_transport.py** - æµ‹è¯•è„šæœ¬

## ğŸ¯ æ€»ç»“

**è¿™æ˜¯è€ƒè™‘æ‰€æœ‰æƒ…å†µåçš„æœ€ä½³æ–¹æ¡ˆï¼š**

âœ… **å…¨é¢æ”¯æŒ**ï¼šbrowser-automationï¼ˆWeb UIï¼‰+ agent-proxyï¼ˆAPIï¼‰+ WebSocket
âœ… **è‡ªåŠ¨é€‚é…**ï¼šæ— éœ€æ‰‹åŠ¨é€‰æ‹©ï¼Œæ™ºèƒ½æ£€æµ‹
âœ… **ç»Ÿä¸€æ¥å£**ï¼šä¸€å¥—ä»£ç ï¼Œé€‚é…æ‰€æœ‰åœºæ™¯
âœ… **æ˜“äºæ‰©å±•**ï¼šæ·»åŠ æ–°ç±»å‹åªéœ€å®ç°æ¥å£
âœ… **å‘åå…¼å®¹**ï¼šä¸å½±å“ç°æœ‰åŠŸèƒ½
âœ… **å·²æµ‹è¯•éªŒè¯**ï¼šå®é™…è¿è¡Œæ­£å¸¸

**ä½ ç°åœ¨å¯ä»¥ç›´æ¥ä½¿ç”¨ `/red-team` æ”»å‡»ä»»ä½•ç±»å‹çš„ç›®æ ‡ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨é€‰æ‹©æœ€ä½³æ–¹å¼ï¼**

## ğŸ“ ä¸‹ä¸€æ­¥

ä½ å¯ä»¥ï¼š

1. **ç›´æ¥ä½¿ç”¨**ï¼š`/red-team http://localhost:8082`
2. **æµ‹è¯•æ£€æµ‹**ï¼š`python test_transport.py <your-url>`
3. **æŸ¥çœ‹æ–‡æ¡£**ï¼š`cat README-TRANSPORT.md`
4. **è‡ªå®šä¹‰æ‰©å±•**ï¼šæ·»åŠ æ–°çš„Transportç±»å‹

æœ‰ä»»ä½•é—®é¢˜éšæ—¶é—®æˆ‘ï¼
